<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable id="GiKhm$Ema#UDV;)T$1st">humidity</variable><variable id="K^0ve?-sB1$qt{qT92!R">MOISTURE_AIR</variable><variable id="u)n!I_XwsBX2qB`p8;J3">MOISTURE_WATER</variable><variable id="}W+A_K{%9(jmId0pUnlK">moistureRaw</variable><variable id="pp0x9[q,B,yfv#}Z?f`L">PIN_MOISTURE</variable><variable id="hL|dk#LI@@(H{C#bkh}2">waterDetected</variable><variable id="y4(=oiehLY?@g3}UG@YZ">PIN_WATER</variable><variable id="Jb:yeoGPtUY1iA5mv7r@">moisture</variable></variables><comment id="Lvi%A1BVOe71O$L4hoyE" x="2" y="-220" w="420" h="200">
Signal digital détection d'eau sur P0
Signal analogique humidité de l'eau sur P1

Fonction de conversion pour l'humidité
</comment><block type="pxt-on-start" id="VFTKx:2oMqYVaP60BSh/" x="0" y="0"><statement name="HANDLER"><block type="typescript_statement" id="@tmvjCN1@)nm%!o4ALO|"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let moistureRaw = 0" numlines="1" declaredvars="moistureRaw"></mutation><next><block type="typescript_statement" id="pwevUC%}gb3+jN:TWU-T"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let waterDetected = 0" numlines="1" declaredvars="waterDetected"></mutation><next><block type="typescript_statement" id="s^EKE0!$E_eBj];d~(9."><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let moisture = 0" numlines="1" declaredvars="moisture"></mutation><next><block type="serial_setbaudrate" id="rw@th]]1:nu*GK.z[Z8+"><field name="rate">BaudRate.BaudRate115200</field><comment pinned="false" h="80" w="160">Initialisation de la communication série</comment><next><block type="serial_writestring" id="b=W:MRc8ic*p5@k;ijx3"><value name="text"><shadow type="text" id="W~qeS`1RhRXr!Gxvyv7="><field name="TEXT"></field></shadow><block type="typescript_expression" id="82x^n^QAeEYcvus[e=l6"><field name="EXPRESSION">("Démarrage du capteur EARTH\n")</field></block></value><next><block type="serial_writestring" id="cgT2/:kVz.qN~EewrBN5"><value name="text"><shadow type="text" id="f)(tLBTr4j9U1JutXy4V"><field name="TEXT"></field></shadow><block type="typescript_expression" id="JI{hmX*AD1lG2YB8.?Q+"><field name="EXPRESSION">("Moisture,WaterDetected\n")</field></block></value><next><block type="variables_set" id="yVe4bJ!nM@]D.:$5|%O#"><field name="VAR" id="K^0ve?-sB1$qt{qT92!R">MOISTURE_AIR</field><comment pinned="false" h="80" w="160">Constantes de calibration
Valeur dans l'air (sec)</comment><value name="VALUE"><shadow type="math_number" id="}hx4%KW1#B6=?,dAsh/-"><field name="NUM">1017</field></shadow></value><next><block type="variables_set" id="H`jvfuBVnhcuqENeaI_%"><field name="VAR" id="u)n!I_XwsBX2qB`p8;J3">MOISTURE_WATER</field><comment pinned="false" h="80" w="160">Valeur dans l'eau</comment><value name="VALUE"><shadow type="math_number" id="-eU9O)A)5]s-?qIz.p{M"><field name="NUM">450</field></shadow></value><next><block type="serial_writestring" id="M_bE9qwK#:YM@5eG7E+K"><comment pinned="false" h="80" w="160">En-tête CSV</comment><value name="text"><shadow type="text" id="CA49h7LR9w7oGu+.]:G."><field name="TEXT"></field></shadow><block type="typescript_expression" id="cU%)aq]s%Eo1J)7p$x:A"><field name="EXPRESSION">("Démarrage du capteur EARTH\n")</field></block></value><next><block type="serial_writestring" id="8#|Y95?V~WJ~Gz(YX~w?"><value name="text"><shadow type="text" id="ncQ1t}*NXCW(,Qo(M{jq"><field name="TEXT"></field></shadow><block type="typescript_expression" id="RSDK5[lzMjsd83G~Mk_9"><field name="EXPRESSION">("DonnéesBrutes,TauxHumidité,DetectionEau\n")</field></block></value><next><block type="variables_set" id="rwCk;31tsZ.Ggh,)V#r9"><field name="VAR" id="pp0x9[q,B,yfv#}Z?f`L">PIN_MOISTURE</field><comment pinned="false" h="80" w="160">Définition des broches
Signal analogique humidité sur P1</comment><value name="VALUE"><shadow type="math_number" id="/,HKa(@$PH.6`uy{BkQS"><field name="NUM">0</field></shadow><block type="analog_pin" id="{Cz7=Ja6,;]}DKz,XCow"><field name="pin">AnalogPin.P1</field></block></value><next><block type="variables_set" id="F.!nz[2vN8WwPxN[Ic^g"><field name="VAR" id="y4(=oiehLY?@g3}UG@YZ">PIN_WATER</field><comment pinned="false" h="80" w="160">Signal digital détection d'eau sur P0</comment><value name="VALUE"><shadow type="math_number" id="5YkPh4I:#Q|djwI2_3XK"><field name="NUM">0</field></shadow><block type="digital_pin" id="w?fwX@2C~YUtBX]6J[;w"><field name="pin">DigitalPin.P0</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type="device_forever" id="zYq:z5q@Q}c^PL|f%I~J" x="710" y="0"><comment pinned="false" h="80" w="160">Boucle principale</comment><statement name="HANDLER"><block type="variables_set" id="SBPa9S9OZ!*(HQM_L^FL"><field name="VAR" id="}W+A_K{%9(jmId0pUnlK">moistureRaw</field><comment pinned="false" h="80" w="160">Lecture des valeurs</comment><value name="VALUE"><shadow type="math_number" id="zQQJ2ZPnwK!{ge=.m3q?"><field name="NUM">0</field></shadow><block type="device_get_analog_pin" id="c_zTngB=u}r;pp;?6aQa"><value name="name"><shadow type="analog_read_write_pin_shadow" id="2X|zVg2FVLr;@a-!ozbq"><field name="pin">AnalogReadWritePin.P0</field></shadow><block type="variables_get" id="m1%)~!+t67D.vyD@/y4-"><field name="VAR" id="pp0x9[q,B,yfv#}Z?f`L">PIN_MOISTURE</field></block></value></block></value><next><block type="variables_set" id="6Rej`MduI,yMYWYuajm~"><field name="VAR" id="hL|dk#LI@@(H{C#bkh}2">waterDetected</field><value name="VALUE"><shadow type="math_number" id="A/{|PyS9LY-=^ptgzxWa"><field name="NUM">0</field></shadow><block type="device_get_digital_pin" id="vW[/gAnc,8y#*Pb~rC_{"><value name="name"><shadow type="digital_pin_shadow" id=")L)rZ]xiT.n]9:bVKf`c"><field name="pin">DigitalPin.P0</field></shadow><block type="variables_get" id="IVm!i_{byAs.M+A0MP(F"><field name="VAR" id="y4(=oiehLY?@g3}UG@YZ">PIN_WATER</field></block></value></block></value><next><block type="variables_set" id="zU)[55d+3*4h.=~x}HIN"><field name="VAR" id="Jb:yeoGPtUY1iA5mv7r@">moisture</field><comment pinned="false" h="80" w="160">Conversion de l'humidité</comment><value name="VALUE"><shadow type="math_number" id=")nZA4~3Tei?NU)ob6M8z"><field name="NUM">0</field></shadow><block type="function_call_output" id="9b`Ny2]8.HNafH}K,eJ["><mutation name="convertMoisture" functionid="ZO99t}i@8Jj=e;ZS|5G9"><arg name="rawValue" id="4a3hqwjvneg018y8ynq4lh" type="number"></arg></mutation><value name="4a3hqwjvneg018y8ynq4lh"><shadow type="math_number" id="q/;[}koe?/hN^m(p}gT="><field name="NUM">1</field></shadow><block type="variables_get" id="^~*DTOnR-(0JS0#`.BX^"><field name="VAR" id="}W+A_K{%9(jmId0pUnlK">moistureRaw</field></block></value></block></value><next><block type="serial_writestring" id="wCL{p]bYL|3$kB^b|A[:"><comment pinned="false" h="80" w="160">Envoi des données sur le port série</comment><value name="text"><shadow type="text" id="dER-iX8`^{zVe,WZav]`"><field name="TEXT"></field></shadow><block type="typescript_expression" id="I9?j.Y425F|[(/Nk;xm8"><field name="EXPRESSION">(moistureRaw.toString())</field></block></value><next><block type="serial_writestring" id="Ly2KzLD$I%X`uZ50*Rkd"><value name="text"><shadow type="text" id="R*p2*,+dV^3[?yh,qmxV"><field name="TEXT">,</field></shadow></value><next><block type="serial_writestring" id="iiDPIseEv$bsbb*IU5*]"><value name="text"><shadow type="text" id="VN|fsf5ctQsD.BJ!qdsf"><field name="TEXT"></field></shadow><block type="typescript_expression" id="ZyAaNg}B!o$ykjk``5`U"><field name="EXPRESSION">(moisture.toString())</field></block></value><next><block type="serial_writestring" id="MaHbEj1.C3-D_O/6!e`V"><value name="text"><shadow type="text" id="uLN[|Zmrw`W_,jx,UdBL"><field name="TEXT">,</field></shadow></value><next><block type="serial_writestring" id="`nd4t/V6KmeQ:%c}8TeS"><value name="text"><shadow type="text" id="A?:kQ_UY}4zwJ!Y^amsU"><field name="TEXT"></field></shadow><block type="typescript_expression" id="N5c~8Yvp:V5oi?76kw/0"><field name="EXPRESSION">(waterDetected.toString())</field></block></value><next><block type="serial_writestring" id="nTAfS~f5sl5$wk$NMwHt"><value name="text"><shadow type="text" id="^NulbK2%VF`?/nsx5m(F"><field name="TEXT"></field></shadow><block type="typescript_expression" id="{oX7mV1v3yp#%d$_J|g!"><field name="EXPRESSION">("\n")</field></block></value><next><block type="controls_if" id="y,Pek2,s0r|hdnj2x5P)"><mutation else="1"></mutation><comment pinned="false" h="80" w="160">Affichage sur la matrice LED selon la présence d'eau</comment><value name="IF0"><shadow type="logic_boolean" id="WZk)/#Q(T=B4,j!`K}Sp"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="sY4e!08-Ij+x?=V9GXqB"><field name="OP">EQ</field><value name="A"><shadow type="math_number" id="Z`lx2Qwg}zS]4IB/p7]E"><field name="NUM">0</field></shadow><block type="variables_get" id="pC]zQOhu$WM1$p]_6k27"><field name="VAR" id="hL|dk#LI@@(H{C#bkh}2">waterDetected</field></block></value><value name="B"><shadow type="math_number" id="EKk`f2MLnWlhZGE:F:W-"><field name="NUM">1</field></shadow></value></block></value><statement name="DO0"><block type="basic_show_icon" id="F=/LJRq7jOn6}{sUybTZ"><field name="i">IconNames.Umbrella</field></block></statement><statement name="ELSE"><block type="basic_show_icon" id="}G=EeDRb!^nK1;4IK46i"><field name="i">IconNames.No</field></block></statement><next><block type="device_pause" id="@`FCZ:1=(F;un#3dKPLR"><comment pinned="false" h="80" w="160">Pause de 1 seconde</comment><value name="pause"><shadow type="timePicker" id="_^)qE$qF(T[(5`+[8u~s"><field name="ms">500</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="}VpV@}vT!G(l6{TEOD[k" x="1476" y="0"><mutation name="convertMoisture" functionid="ZO99t}i@8Jj=e;ZS|5G9"><arg name="rawValue" id="4a3hqwjvneg018y8ynq4lh" type="number"></arg></mutation><field name="function_name">convertMoisture</field><comment pinned="false" h="80" w="160">Valeur dans l'eau
Fonction de conversion pour l'humidité
return humidity</comment><data>0</data><value name="4a3hqwjvneg018y8ynq4lh"><block type="argument_reporter_number" id="rq(){N|IGhT;0/`FvH_r"><mutation duplicateondrag="true"></mutation><field name="VALUE">rawValue</field></block></value><statement name="STACK"><block type="variables_set" id="ndt]{P:UeU|Xin|}yiU#"><field name="VAR" id="GiKhm$Ema#UDV;)T$1st">humidity</field><comment pinned="false" h="80" w="160">Conversion en pourcentage avec inversion de l'échelle
et limitation entre 0 et 100%</comment><value name="VALUE"><shadow type="math_number" id="[79s-g1XChs/0w#:_9MN"><field name="NUM">0</field></shadow><block type="math_map" id="rb.)?QCpa?VK,,?|{?U|"><value name="value"><block type="argument_reporter_number" id="T)I+V:xf?~;}XRcCOyLw"><field name="VALUE">rawValue</field></block></value><value name="fromLow"><block type="variables_get" id="/uSsM)oKm/!LC7Z,`X(p"><field name="VAR" id="K^0ve?-sB1$qt{qT92!R">MOISTURE_AIR</field></block></value><value name="fromHigh"><block type="variables_get" id="A^p~`p=.]T[dVJR+-]v%"><field name="VAR" id="u)n!I_XwsBX2qB`p8;J3">MOISTURE_WATER</field></block></value><value name="toLow"><shadow type="math_number" id="5;!|(odJy]*Gwa|0XYp6"><field name="NUM">0</field></shadow></value><value name="toHigh"><shadow type="math_number" id="F6C4V_2k3n=Ro?!I$yK@"><field name="NUM">100</field></shadow></value></block></value><next><block type="controls_if" id="+9T*yiej3~z_d]{~/qz%"><comment pinned="false" h="80" w="160">Limiter les valeurs entre 0 et 100</comment><value name="IF0"><shadow type="logic_boolean" id="6{DHd^?qnr},`Bg$Sh*F"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="83,HOci$P=PE;8b1mKPR"><field name="OP">LT</field><value name="A"><shadow type="math_number" id="NQ:J%(-p5z.A`te0Hr@q"><field name="NUM">0</field></shadow><block type="variables_get" id="z%D[jIfWCq[8%jEnP;H."><field name="VAR" id="GiKhm$Ema#UDV;)T$1st">humidity</field></block></value><value name="B"><shadow type="math_number" id="P?][n:wb~A9H{WuI1(MA"><field name="NUM">0</field></shadow></value></block></value><statement name="DO0"><block type="variables_set" id="6{/FJ33gQwU+I0){amHJ"><field name="VAR" id="GiKhm$Ema#UDV;)T$1st">humidity</field><value name="VALUE"><shadow type="math_number" id="eEF)Ba-{UD%nTWxH{1j["><field name="NUM">0</field></shadow></value></block></statement><next><block type="controls_if" id="!Ks:VmQYYBBZG}]TVbo|"><value name="IF0"><shadow type="logic_boolean" id="xL7x?%c1e!N0Kr5]QD_L"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="HO!vIA{yRLx3HnvseNj;"><field name="OP">GT</field><value name="A"><shadow type="math_number" id="$?F{8u~Gl5oQ|T_XB^f!"><field name="NUM">0</field></shadow><block type="variables_get" id="y4k@5j!WVq1cLSR:;YkS"><field name="VAR" id="GiKhm$Ema#UDV;)T$1st">humidity</field></block></value><value name="B"><shadow type="math_number" id="qX[[WnTk}VOkgWdMfi5G"><field name="NUM">100</field></shadow></value></block></value><statement name="DO0"><block type="variables_set" id="#g3)U/HQWyOBy$@p(TNO"><field name="VAR" id="GiKhm$Ema#UDV;)T$1st">humidity</field><value name="VALUE"><shadow type="math_number" id="^Oca*u8v_M6nsbIap3_."><field name="NUM">100</field></shadow></value></block></statement><next><block type="function_return" id="dO~6tvrv+k-bGx6x7#D-"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number" id="a*^9l^RftUC3t2Mi-27E"><field name="NUM">0</field></shadow><block type="math_js_round" id="7Pv%mp@A/!F70EF#{v66"><field name="OP">round</field><value name="ARG0"><shadow type="math_number" id="SImYi/8TCh0vdT6P3az9"><field name="NUM">0</field></shadow><block type="variables_get" id="zt-v#DQs|Nv!czvSeLLD"><field name="VAR" id="GiKhm$Ema#UDV;)T$1st">humidity</field></block></value></block></value></block></next></block></next></block></next></block></statement></block></xml>